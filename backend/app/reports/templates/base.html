<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Rapport{% endblock %} — ESG Mefali</title>
  <style>
    /* ── Reset & Base ── */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    @page {
      size: A4;
      margin: 20mm 18mm 25mm 18mm;
      @bottom-center {
        content: "Page " counter(page) " / " counter(pages);
        font-size: 8pt;
        color: #94a3b8;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 10pt;
      line-height: 1.5;
      color: #1e293b;
    }

    /* ── Typography ── */
    h1 { font-size: 22pt; font-weight: 700; color: #065f46; margin-bottom: 8pt; }
    h2 { font-size: 15pt; font-weight: 600; color: #065f46; margin-top: 18pt; margin-bottom: 8pt; border-bottom: 2px solid #d1fae5; padding-bottom: 4pt; }
    h3 { font-size: 12pt; font-weight: 600; color: #047857; margin-top: 12pt; margin-bottom: 6pt; }
    p { margin-bottom: 6pt; }

    /* ── Cover Page ── */
    .cover {
      page-break-after: always;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 85vh;
      text-align: center;
    }
    .cover .logo {
      font-size: 32pt;
      font-weight: 800;
      color: #059669;
      letter-spacing: -1pt;
      margin-bottom: 6pt;
    }
    .cover .subtitle {
      font-size: 11pt;
      color: #64748b;
      margin-bottom: 40pt;
    }
    .cover .report-title {
      font-size: 26pt;
      font-weight: 700;
      color: #1e293b;
      margin-bottom: 12pt;
    }
    .cover .company-name {
      font-size: 16pt;
      font-weight: 600;
      color: #047857;
      margin-bottom: 6pt;
    }
    .cover .date {
      font-size: 10pt;
      color: #94a3b8;
      margin-top: 30pt;
    }
    .cover .separator {
      width: 80px;
      height: 3px;
      background: #059669;
      margin: 16pt auto;
      border-radius: 2px;
    }

    /* ── Section containers ── */
    .section { margin-bottom: 20pt; }
    .section-break { page-break-before: always; }

    /* ── Score cards ── */
    .score-grid {
      display: flex;
      gap: 12pt;
      margin: 12pt 0;
    }
    .score-card {
      flex: 1;
      border: 1px solid #e2e8f0;
      border-radius: 8pt;
      padding: 12pt;
      text-align: center;
    }
    .score-card .label {
      font-size: 9pt;
      text-transform: uppercase;
      letter-spacing: 0.5pt;
      color: #64748b;
      margin-bottom: 4pt;
    }
    .score-card .value {
      font-size: 24pt;
      font-weight: 700;
    }
    .score-card .max { font-size: 10pt; color: #94a3b8; }

    .score-excellent { color: #059669; }
    .score-good { color: #0d9488; }
    .score-average { color: #d97706; }
    .score-low { color: #dc2626; }

    /* ── Tables ── */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 10pt 0;
      font-size: 9pt;
    }
    th, td {
      border: 1px solid #e2e8f0;
      padding: 6pt 8pt;
      text-align: left;
    }
    th {
      background: #f0fdf4;
      font-weight: 600;
      color: #065f46;
    }
    tr:nth-child(even) td { background: #f8fafc; }

    /* ── Progress bar ── */
    .progress-bar {
      height: 10pt;
      background: #e2e8f0;
      border-radius: 5pt;
      overflow: hidden;
    }
    .progress-bar .fill {
      height: 100%;
      border-radius: 5pt;
      background: linear-gradient(90deg, #059669, #10b981);
    }

    /* ── Badge ── */
    .badge {
      display: inline-block;
      padding: 2pt 8pt;
      border-radius: 10pt;
      font-size: 8pt;
      font-weight: 600;
    }
    .badge-green { background: #d1fae5; color: #065f46; }
    .badge-yellow { background: #fef3c7; color: #92400e; }
    .badge-red { background: #fee2e2; color: #991b1b; }
    .badge-blue { background: #dbeafe; color: #1e40af; }

    /* ── Chart container ── */
    .chart-container {
      text-align: center;
      margin: 14pt 0;
    }
    .chart-container img {
      max-width: 100%;
      height: auto;
    }

    /* ── Info box ── */
    .info-box {
      background: #f0fdf4;
      border-left: 4px solid #059669;
      padding: 10pt 14pt;
      margin: 10pt 0;
      border-radius: 0 6pt 6pt 0;
    }
    .info-box.warning {
      background: #fffbeb;
      border-left-color: #d97706;
    }

    /* ── Footer ── */
    .report-footer {
      margin-top: 30pt;
      padding-top: 10pt;
      border-top: 1px solid #e2e8f0;
      font-size: 8pt;
      color: #94a3b8;
      text-align: center;
    }

    /* ── Utilities ── */
    .text-center { text-align: center; }
    .text-right { text-align: right; }
    .text-muted { color: #64748b; }
    .text-sm { font-size: 9pt; }
    .mt-2 { margin-top: 8pt; }
    .mb-2 { margin-bottom: 8pt; }
    .flex { display: flex; }
    .gap-2 { gap: 8pt; }
  </style>
  {% block extra_styles %}{% endblock %}
</head>
<body>
  {% block cover %}{% endblock %}
  {% block content %}{% endblock %}

  <div class="report-footer">
    Rapport généré par ESG Mefali — {{ date_generation }} — Confidentiel
  </div>
</body>
</html>
